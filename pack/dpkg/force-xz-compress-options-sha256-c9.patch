diff -Nuar a/lib/dpkg/compress.c b/lib/dpkg/compress.c
--- a/lib/dpkg/compress.c	2014-02-06 08:21:34.424608732 +0100
+++ b/lib/dpkg/compress.c	2014-02-07 08:11:52.780314304 +0100
@@ -531,10 +531,11 @@
 
 	io->status |= DPKG_STREAM_COMPRESS;
 
-	preset = io->params->level;
+	//preset = io->params->level;
+	preset = 9;
 	if (io->params->strategy == compressor_strategy_extreme)
 		preset |= LZMA_PRESET_EXTREME;
-	ret = lzma_easy_encoder(s, preset, LZMA_CHECK_CRC32);
+	ret = lzma_easy_encoder(s, preset, LZMA_CHECK_SHA256);
 	if (ret != LZMA_OK)
 		filter_lzma_error(io, ret);
 }
@@ -595,7 +596,8 @@
 static void
 compress_xz(int fd_in, int fd_out, struct compress_params *params, const char *desc)
 {
-	char combuf[6];
+	char combuf[64];
+	const char *check = "--check=sha256";
 	const char *strategy;
 
 	if (params->strategy == compressor_strategy_extreme)
@@ -603,15 +605,15 @@
 	else
 		strategy = NULL;
 
-	snprintf(combuf, sizeof(combuf), "-c%d", params->level);
-	fd_fd_filter(fd_in, fd_out, desc, env_xz, XZ, combuf, strategy, NULL);
+	snprintf(combuf, sizeof(combuf), "-c9");
+	fd_fd_filter(fd_in, fd_out, desc, env_xz, XZ, combuf, strategy, check, NULL);
 }
 #endif
 
 static const struct compressor compressor_xz = {
 	.name = "xz",
 	.extension = ".xz",
-	.default_level = 6,
+	.default_level = 9,
 	.fixup_params = fixup_none_params,
 	.compress = compress_xz,
 	.decompress = decompress_xz,
